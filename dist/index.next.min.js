var A1=function(t){"use strict";const r=t=>{let r,s="";for(;t>0;)r=(t-1)%26,s=String.fromCharCode(r+65)+s,t=(t-r-1)/26;return s},s=t=>parseInt(t,10),e=t=>String(t),i=t=>typeof t,n=t=>"string"===i(t),o=t=>"number"===i(t)&&Number.isInteger(t),h=t=>o(t)&&t>0,a=t=>n(t)&&/^[0-9]+$/.test(t)&&h(+t),c=t=>n(t)&&/^[a-z]+$/i.test(t),_=t=>n(t)&&/^[A-Z]+\d+(:[A-Z]+\d+)?$/i.test(t);class l extends Error{constructor(t){const r=JSON.stringify(t);super(r),this.name="A1Error",this.message=r}s(){return this.message=`Invalid A1 notation: ${this.message}`,this}n(){return this.message=`Invalid A1 number(s): ${this.message}`,this}u(){return this.message=`Invalid A1 argument(s): ${this.message}`,this}}var d;!function(t){t.X="col",t.Y="row"}(d||(d={}));class w{static _reg=/^([A-Z]+)(\d+)(?::([A-Z]+)(\d+))?$/;_colStart=0;_rowStart=0;_colEnd=0;_rowEnd=0;_converter=1;static _parse(t,r){let[,e,i,n,o]=t.toUpperCase().match(this._reg);n=n||e,o=o||i;const h=this._A1Col(e,r),a=this._A1Col(n,r),c=s(i),_=s(o);return{cs:a>h?h:a,rs:_>c?c:_,ce:a>h?a:h,re:_>c?_:c}}static _A1Col(t,r){return 1===r?(t=>{const r=t.length;let s=0;for(let e=0;e<r;e++)s+=(t.charCodeAt(e)-64)*Math.pow(26,r-e-1);return s})(t):(t=>{let r,s,e,i=0,n="A".charCodeAt(0),o="Z".charCodeAt(0)-n+1;for(r=0,s=t.length;r<s;r++)e=t.charCodeAt(r),i=i*o+e-n+1;return i})(t)}static isValid(t){return _(t)}static getCol(t,r=1){if(!_(t))throw new l(t).s();return this._parse(t,r).cs}static getLastCol(t,r=1){if(!_(t))throw new l(t).s();return this._parse(t,r).ce}static toCol(t){if(!h(t))throw new l(t).n();return r(t)}static getRow(t){if(!_(t))throw new l(t).s();return this._parse(t,1).rs}static getLastRow(t){if(!_(t))throw new l(t).s();return this._parse(t,1).re}static toRow(t){if(!h(t))throw new l(t).n();return e(t)}static getWidth(t,r=1){if(!_(t))throw new l(t).s();let{ce:s,cs:e}=this._parse(t,r);return s-e+1}static getHeight(t){if(!_(t))throw new l(t).s();let{re:r,rs:s}=this._parse(t,1);return r-s+1}_initObject(t){const{a1Start:r,a1End:s,colStart:e,colEnd:i,rowStart:n,rowEnd:o,nCols:d,nRows:u,converter:f}=t;let g,S,E,m;this._converter=2===f?2:1;const v=(t,r=!0)=>h(t)||a(t)?+t:r&&c(t)?w._A1Col(t,this._converter):0;if(_(r)){const t=w._parse(r,this._converter);g=t.cs,E=t.rs;const s=t.cs===t.ce,e=t.rs===t.re,i=s&&e;(!i||i&&r.includes(":"))&&(S=t.ce,m=t.re)}if(!g&&e&&(g=v(e)),!E&&n&&(E=v(n,!1)),!S&&!m&&_(s)){const t=w._parse(s,this._converter);S=t.ce,m=t.re}if(!S&&i&&(S=v(i)),!m&&o&&(m=v(o,!1)),!S&&g&&h(d)&&(S=g+d-1),!m&&E&&h(u)&&(m=E+u-1),g&&!S&&(S=g),!g&&S&&(g=S),E&&!m&&(m=E),!E&&m&&(E=m),!(g&&E&&S&&m))throw new l(t).u();this._colStart=g,this._rowStart=E,this._colEnd=S,this._rowEnd=m}_initNumber(...t){let[r,s,e,i]=t;e=e||1,i=i||1;let n=[r,s,e,i];if(!n.every((t=>h(t))))throw new l(n.join(", ")).n();this._colStart=r,this._rowStart=s,this._colEnd=r+i-1,this._rowEnd=s+e-1}_initString(...t){const[r,s]=t,e=s?`${r}:${s}`:r;if(!_(e))throw new l(e).s();const{cs:i,rs:n,ce:o,re:h}=w._parse(e,this._converter);this._colStart=i,this._rowStart=n,this._colEnd=o,this._rowEnd=h}constructor(t,r,s,e){if(!arguments.length)throw(new l).u();if(t&&"object"===i(t))this._initObject(t);else if(o(t))this._initNumber.apply(this,arguments);else{if(!n(t))throw new l(t).u();this._initString.apply(this,arguments)}}get(){const t=r(this._colStart)+e(this._rowStart),s=r(this._colEnd)+e(this._rowEnd);return t===s?t:`${t}:${s}`}toString(){return this.get()}toJSON(){return{colStart:this._colStart,rowStart:this._rowStart,colEnd:this._colEnd,rowEnd:this._rowEnd,a1:this.get(),rowsCount:this._rowEnd-this._rowStart+1,colsCount:this._colEnd-this._colStart+1}}getCol(){return this._colStart}getLastCol(){return this._colEnd}getRow(){return this._rowStart}getLastRow(){return this._rowEnd}getWidth(){return this._colEnd-this._colStart+1}getHeight(){return this._rowEnd-this._rowStart+1}copy(){return new w(this.get())}setCol(t){return this._setFields(t,"_colStart",d.X)}setLastCol(t){return this._setFields(t,"_colEnd",d.X)}setRow(t){return this._setFields(t,"_rowStart",d.Y,!1)}setLastRow(t){return this._setFields(t,"_rowEnd",d.Y,!1)}addX(t){return this._addFields(t,d.X)}addY(t){return this._addFields(t,d.Y)}add(t,r){return this.addX(t).addY(r)}removeX(t){return this._removeFields(t,d.X)}removeY(t){return this._removeFields(t,d.Y)}remove(t,r){return this.removeX(t).removeY(r)}shiftX(t){return this._shiftFields(t,d.X)}shiftY(t){return this._shiftFields(t,d.Y)}shift(t,r){return this.shiftX(t).shiftY(r)}_setFields(t,r,s,e=!0){if(h(t)||a(t))this[r]=+t;else{if(!e||!c(t))throw new l(t).u();this[r]=w._A1Col(t,this._converter)}if(this[`_${s}Start`]>this[`_${s}End`])throw new l(`The first column or row can't be bigger than the last, got: ${t}`);return this}_addFields(t,r){if(!o(t))throw new l(t).u();const s=`_${r}Start`;return t>=0?this[`_${r}End`]+=t:this[s]+=t,this[s]<=0&&(this[s]=1),this}_removeFields(t,r){if(!o(t))throw new l(t).u();const s=`_${r}Start`,e=`_${r}End`;return t>=0?(this[e]-=t,this[e]<this[s]&&(this[e]=this[s])):(this[s]-=t,this[s]>this[e]&&(this[s]=this[e])),this}_shiftFields(t,r){if(!o(t))throw new l(t).u();const s=`_${r}Start`,e=`_${r}End`,i=this[e]-this[s],n=this[s]+t,h=this[e]+t;return this[s]=n>0?n:1,this[e]=n>0?h:i+1,this}}return t.A1=w,t.default=w,Object.defineProperty(t,"__esModule",{value:!0}),t}({});
