var A1=function(){"use strict";const t=t=>{let r,s="";for(;t>0;)r=(t-1)%26,s=String.fromCharCode(r+65)+s,t=(t-r-1)/26;return s},r=t=>parseInt(t,10),s=t=>t.toString();function i(t){return/^[A-Z]+\d+(:[A-Z]+\d+)?$/i.test(t)}function n(t,r=!0){const s="number"==typeof t&&Number.isInteger(t);return r?s&&+t>0:s}class e extends Error{constructor(t){const r=JSON.stringify(t);super(r),this.name="A1Error",this.message=r}wasString(){return this.message=`Invalid A1 notation: ${this.message}`,this}wasNumber(){return this.message=`Invalid A1 number(s): ${this.message}`,this}wasUnknown(){return this.message=`Invalid A1 argument(s): ${this.message}`,this}}class o{constructor(t,r,s,i){if(this._colStart=0,this._rowStart=0,this._colEnd=0,this._rowEnd=0,this._converter=1,!arguments.length)throw(new e).wasUnknown();const n=typeof t;if(t&&"object"===n)this._initObject(t);else if("number"===n)this._initNumber.apply(this,arguments);else{if("string"!==n)throw new e(t).wasUnknown();this._initString.apply(this,arguments)}}static _parse(t,s){let[,i,n,e,o]=t.toUpperCase().match(this._reg);e=e||i,o=o||n;const h=this._A1Col(i,s),a=this._A1Col(e,s),w=r(n),c=r(o);return{cs:a>h?h:a,rs:c>w?w:c,ce:a>h?a:h,re:c>w?c:w}}static _A1Col(t,r){return 1===r?(t=>{const r=t.length;let s=0;for(let i=0;i<r;i++)s+=(t.charCodeAt(i)-64)*Math.pow(26,r-i-1);return s})(t):(t=>{let r,s,i,n=0,e="A".charCodeAt(0),o="Z".charCodeAt(0)-e+1;for(r=0,s=t.length;r<s;r++)i=t.charCodeAt(r),n=n*o+i-e+1;return n})(t)}static isValid(t){return i(t)}static getCol(t,r=1){if(!i(t))throw new e(t).wasString();return this._parse(t,r).cs}static getLastCol(t,r=1){if(!i(t))throw new e(t).wasString();return this._parse(t,r).ce}static toCol(r){if(!n(r))throw new e(r).wasNumber();return t(r)}static getRow(t){if(!i(t))throw new e(t).wasString();return this._parse(t,1).rs}static getLastRow(t){if(!i(t))throw new e(t).wasString();return this._parse(t,1).re}static toRow(t){if(!n(t))throw new e(t).wasNumber();return s(t)}static getWidth(t,r=1){if(!i(t))throw new e(t).wasString();let{ce:s,cs:n}=this._parse(t,r);return s-n+1}static getHeight(t){if(!i(t))throw new e(t).wasString();let{re:r,rs:s}=this._parse(t,1);return r-s+1}_initObject(t){const r=t=>"string"==typeof t,s=n,h=t=>/^[a-z]+$/i.test(t),a=t=>(t=>"string"==typeof t&&/^[0-9]+$/.test(t))(t)&&s(+t),{a1Start:w,a1End:c,colStart:_,colEnd:l,rowStart:d,rowEnd:u,nCols:S,nRows:g,converter:E}=t;let f,m,p,C;if(this._converter=2===E?2:1,r(w)&&i(w)){const t=o._parse(w,this._converter);f=t.cs,p=t.rs;const r=t.cs===t.ce,s=t.rs===t.re,i=r&&s;(!i||i&&w.includes(":"))&&(m=t.ce,C=t.re)}if(!f&&_&&(s(_)?f=_:r(_)&&(h(_)?f=o._A1Col(_,this._converter):a(_)&&(f=+_))),p||!s(d)&&!a(d)||(p=+d),!m&&!C&&r(c)&&i(c)){const t=o._parse(c,this._converter);m=t.ce,C=t.re}if(!m&&l&&(s(l)?m=l:r(l)&&(h(l)?m=o._A1Col(l,this._converter):a(l)&&(m=+l))),C||!s(u)&&!a(u)||(C=+u),!m&&f&&s(S)&&(m=f+S-1),!C&&p&&s(g)&&(C=p+g-1),f&&!m&&(m=f),!f&&m&&(f=m),p&&!C&&(C=p),!p&&C&&(p=C),!(f&&p&&m&&C))throw new e(t).wasUnknown();this._colStart=f,this._rowStart=p,this._colEnd=m,this._rowEnd=C}_initNumber(...t){let[r,s,i,o]=t;i=i||1,o=o||1;let h=[r,s,i,o];if(!h.every((t=>n(t))))throw new e(h.join(", ")).wasNumber();this._colStart=r,this._rowStart=s,this._colEnd=r+o-1,this._rowEnd=s+i-1}_initString(...t){const[r,s]=t,n=s?`${r}:${s}`:r;if(!i(n))throw new e(n).wasString();const{cs:h,rs:a,ce:w,re:c}=o._parse(n,this._converter);this._colStart=h,this._rowStart=a,this._colEnd=w,this._rowEnd=c}get(){let r=t(this._colStart)+s(this._rowStart),i=t(this._colEnd)+s(this._rowEnd);return r===i?r:`${r}:${i}`}toString(){return this.get()}toJSON(){return{colStart:this._colStart,rowStart:this._rowStart,colEnd:this._colEnd,rowEnd:this._rowEnd,a1:this.get(),rowsCount:this._rowEnd-this._rowStart+1,colsCount:this._colEnd-this._colStart+1}}getCol(){return this._colStart}getLastCol(){return this._colEnd}getRow(){return this._rowStart}getLastRow(){return this._rowEnd}getWidth(){return this._colEnd-this._colStart+1}getHeight(){return this._rowEnd-this._rowStart+1}copy(){return new o(this.get())}addX(t){if(!n(t,!1))throw new e(t).wasUnknown();return t>=0?this._colEnd+=t:this._colStart+=t,this._colStart<=0&&(this._colStart=1),this}addY(t){if(!n(t,!1))throw new e(t).wasUnknown();return t>=0?this._rowEnd+=t:this._rowStart+=t,this._rowStart<=0&&(this._rowStart=1),this}add(t,r){return this.addX(t),this.addY(r),this}removeX(t){if(!n(t,!1))throw new e(t).wasUnknown();return t>=0?(this._colEnd-=t,this._colEnd<this._colStart&&(this._colEnd=this._colStart)):(this._colStart-=t,this._colStart>this._colEnd&&(this._colStart=this._colEnd)),this}removeY(t){if(!n(t,!1))throw new e(t).wasUnknown();return t>=0?(this._rowEnd-=t,this._rowEnd<this._rowStart&&(this._rowEnd=this._rowStart)):(this._rowStart-=t,this._rowStart>this._rowEnd&&(this._rowStart=this._rowEnd)),this}remove(t,r){return this.removeX(t),this.removeY(r),this}shiftX(t){if(!n(t,!1))throw new e(t).wasUnknown();let r=this._colEnd-this._colStart,s=this._colStart+t,i=this._colEnd+t;return this._colStart=s>0?s:1,this._colEnd=s>0?i:r+1,this}shiftY(t){if(!n(t,!1))throw new e(t).wasUnknown();let r=this._rowEnd-this._rowStart,s=this._rowStart+t,i=this._rowEnd+t;return this._rowStart=s>0?s:1,this._rowEnd=s>0?i:r+1,this}shift(t,r){return this.shiftX(t),this.shiftY(r),this}}return o._reg=/^([A-Z]+)(\d+)(?::([A-Z]+)(\d+))?$/,o}();
//# sourceMappingURL=index.next.min.js.map
