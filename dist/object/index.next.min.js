var A1=function(){"use strict";function t(t){return parseInt(t,10)}function r(t){let r,i="";for(;t>0;)r=(t-1)%26,i=String.fromCharCode(r+65)+i,t=(t-r-1)/26;return i}function i(t){return t.toString()}function s(t){return/^[A-Z]+\d+(:[A-Z]+\d+)?$/i.test(t)}function n(t,r=!0){let i="number"==typeof t&&Number.isInteger(t);return r?i&&+t>0:i}class e extends Error{constructor(t){let r=JSON.stringify(t);super(r),this.name="A1Error",this.message=r}wasString(){return this.message=`Invalid A1 notation: ${this.message}`,this}wasNumber(){return this.message=`Invalid A1 number(s): ${this.message}`,this}wasUnknown(){return this.message=`Invalid A1 argument(s): ${this.message}`,this}}class o{constructor(t,r,i,s){if(this._colStart=0,this._rowStart=0,this._colEnd=0,this._rowEnd=0,this._converter=1,!arguments.length)throw(new e).wasUnknown();let n=typeof t;if(t&&"object"===n)this._initObject.apply(this,arguments);else if("number"===n)this._initNumber.apply(this,arguments);else{if("string"!==n)throw new e(t).wasUnknown();this._initString.apply(this,arguments)}}static _parse(r,i){let[,s,n,e,o]=r.toUpperCase().match(this._reg);e=e||s,o=o||n;let a=this._A1Col(s,i),h=this._A1Col(e,i),l=t(n),w=t(o);return{cs:h>a?a:h,rs:w>l?l:w,ce:h>a?h:a,re:w>l?w:l}}static _A1Col(t,r){return 1===r?function(t){let r=0,i=t.length;for(let s=0;s<i;s++)r+=(t.charCodeAt(s)-64)*Math.pow(26,i-s-1);return r}(t):function(t){let r,i,s,n=0,e="A".charCodeAt(0),o="Z".charCodeAt(0)-e+1;for(r=0,i=t.length;r<i;r++)s=t.charCodeAt(r),n=n*o+s-e+1;return n}(t)}static isValid(t){return s(t)}static getCol(t,r=1){if(!s(t))throw new e(t).wasString();return this._parse(t,r).cs}static getLastCol(t,r=1){if(!s(t))throw new e(t).wasString();return this._parse(t,r).ce}static toCol(t){if(!n(t))throw new e(t).wasNumber();return r(t)}static getRow(t){if(!s(t))throw new e(t).wasString();return this._parse(t,1).rs}static getLastRow(t){if(!s(t))throw new e(t).wasString();return this._parse(t,1).re}static toRow(t){if(!n(t))throw new e(t).wasNumber();return i(t)}static getWidth(t,r=1){if(!s(t))throw new e(t).wasString();let{ce:i,cs:n}=this._parse(t,r);return i-n+1}static getHeight(t){if(!s(t))throw new e(t).wasString();let{re:r,rs:i}=this._parse(t,1);return r-i+1}_initObject(...t){const r=t=>"string"==typeof t,i=(t,r)=>{!Array.isArray(r)&&(r=[r]);for(let i in t)if(!r.includes(i)&&t[i].val)return!1;return!0};let s=t[0],{converter:o}=s;if(o&&![1,2].includes(o))throw new e({converter:o}).wasUnknown();this._converter=o||1;let a={};["colStart","rowStart","colEnd","rowEnd","a1Start","a1End","nCols","nRows"].forEach(t=>{let i=s[t];a[t]={isString:r(i),isNumber:n(i),val:i}});let{colStart:h,rowStart:l,colEnd:w,rowEnd:c,a1Start:u,a1End:S,nCols:_,nRows:d}=a;switch(!0){case u.isString&&i(a,"a1Start"):return this._initString(u.val);case u.isString&&S.isString&&i(a,["a1Start","a1End"]):return this._initString(u.val,S.val);case h.isString&&l.isString&&i(a,["colStart","rowStart"]):return this._initString(h.val+l.val);case h.isNumber&&l.isNumber&&i(a,["colStart","rowStart"]):return this._initNumber(h.val,l.val);case h.isNumber&&l.isNumber&&d.isNumber&&i(a,["colStart","rowStart","nRows"]):return this._initNumber(h.val,l.val,d.val);case h.isNumber&&l.isNumber&&_.isNumber&&i(a,["colStart","rowStart","nCols"]):return this._initNumber(h.val,l.val,1,_.val);case h.isNumber&&l.isNumber&&d.isNumber&&_.isNumber&&i(a,["colStart","rowStart","nRows","nCols"]):return this._initNumber(h.val,l.val,d.val,_.val);case h.isString&&l.isString&&w.isString&&i(a,["colStart","rowStart","colEnd"]):return this._initString(`${h.val}${l.val}:${w.val}${l.val}`);case h.isNumber&&l.isNumber&&w.isNumber&&i(a,["colStart","rowStart","colEnd"]):return this._initNumber(h.val,l.val,1,w.val-h.val+1);case h.isString&&l.isString&&c.isString&&i(a,["colStart","rowStart","rowEnd"]):return this._initString(`${h.val}${l.val}:${h.val}${c.val}`);case h.isNumber&&l.isNumber&&c.isNumber&&i(a,["colStart","rowStart","rowEnd"]):return this._initNumber(h.val,l.val,c.val-l.val+1);case h.isString&&l.isString&&w.isString&&c.isString&&i(a,["colStart","rowStart","colEnd","rowEnd"]):return this._initString(`${h.val}${l.val}:${w.val}${c.val}`);case h.isNumber&&l.isNumber&&w.isNumber&&c.isNumber&&i(a,["colStart","rowStart","colEnd","rowEnd"]):return this._initNumber(h.val,l.val,c.val-l.val+1,w.val-h.val+1);default:throw new e(s).wasUnknown()}}_initNumber(...t){let[r,i,s,o]=t;s=s||1,o=o||1;let a=[r,i,s,o];if(!a.every(t=>n(t)))throw new e(a.join(", ")).wasNumber();this._colStart=r,this._rowStart=i,this._colEnd=r+o-1,this._rowEnd=i+s-1}_initString(...t){let[r,i]=t,n=i?`${r}:${i}`:r;if(!s(n))throw new e(n).wasString();let{cs:a,rs:h,ce:l,re:w}=o._parse(n,this._converter);this._colStart=a,this._rowStart=h,this._colEnd=l,this._rowEnd=w}get(){let t=r(this._colStart)+i(this._rowStart),s=r(this._colEnd)+i(this._rowEnd);return t===s?t:`${t}:${s}`}toString(){return this.get()}toJSON(){return{colStart:this._colStart,rowStart:this._rowStart,colEnd:this._colEnd,rowEnd:this._rowEnd,a1:this.get(),rowsCount:this._rowEnd-this._rowStart+1,colsCount:this._colEnd-this._colStart+1}}getCol(){return this._colStart}getLastCol(){return this._colEnd}getRow(){return this._rowStart}getLastRow(){return this._rowEnd}getWidth(){return this._colEnd-this._colStart+1}getHeight(){return this._rowEnd-this._rowStart+1}copy(){return new o(this.get())}addX(t){if(!n(t,!1))throw new e(t).wasUnknown();return t>=0?this._colEnd+=t:this._colStart+=t,this._colStart<=0&&(this._colStart=1),this}addY(t){if(!n(t,!1))throw new e(t).wasUnknown();return t>=0?this._rowEnd+=t:this._rowStart+=t,this._rowStart<=0&&(this._rowStart=1),this}add(t,r){return this.addX(t),this.addY(r),this}removeX(t){if(!n(t,!1))throw new e(t).wasUnknown();return t>=0?(this._colEnd-=t,this._colEnd<this._colStart&&(this._colEnd=this._colStart)):(this._colStart-=t,this._colStart>this._colEnd&&(this._colStart=this._colEnd)),this}removeY(t){if(!n(t,!1))throw new e(t).wasUnknown();return t>=0?(this._rowEnd-=t,this._rowEnd<this._rowStart&&(this._rowEnd=this._rowStart)):(this._rowStart-=t,this._rowStart>this._rowEnd&&(this._rowStart=this._rowEnd)),this}remove(t,r){return this.removeX(t),this.removeY(r),this}shiftX(t){if(!n(t,!1))throw new e(t).wasUnknown();let r=this._colEnd-this._colStart,i=this._colStart+t,s=this._colEnd+t;return this._colStart=i>0?i:1,this._colEnd=i>0?s:r+1,this}shiftY(t){if(!n(t,!1))throw new e(t).wasUnknown();let r=this._rowEnd-this._rowStart,i=this._rowStart+t,s=this._rowEnd+t;return this._rowStart=i>0?i:1,this._rowEnd=i>0?s:r+1,this}shift(t,r){return this.shiftX(t),this.shiftY(r),this}}return o._reg=/^([A-Z]+)(\d+)(?::([A-Z]+)(\d+))?$/,o}();
//# sourceMappingURL=index.next.min.js.map
